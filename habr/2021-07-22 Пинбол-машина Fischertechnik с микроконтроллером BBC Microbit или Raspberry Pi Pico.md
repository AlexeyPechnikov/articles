# Пинбол-машина Fischertechnik с микроконтроллером BBC Microbit или Raspberry Pi Pico

Опубликовано https://habr.com/ru/post/583834/

~~Давно не брал я в руки Dremel~~ Пора продолжить тему предыдущих статей про творческий подход к конструкторам Фишертехник, смотрите предыдущую публикацию [Конструктор Fischertechnik и Dremel: допиливаем моторы, сервоприводы и пневматическую присоску](https://habr.com/ru/post/535010/)

Есть такой замечательный конструктор Фишертехник [ROBO TX ЭлектроПневматика](http://pacpac.ru/product/516186-robo-tx-electropneumatic/) (на странице по ссылке доступен документ со списком официальных деталей) и к нему методические материалы на разных языках, включая [русскоязычную версию на сайте официального дилера ПакПак](http://pacpac.ru/ft/ab/pdf-bak/ROBO%20TX%20ElectroPneumatic%20RUS%20516186.pdf). Все с ними хорошо, кроме стоимости микроконтроллера, компрессора и электромагнитных клапанов, которые легко можно заменить на совместимые, что мы и сделаем. Эта статья ориентирована на желающих подобрать совместимые с Фишертехником компоненты, поскольку довольно много времени занимает выбор совместимых деталей, ожидание их доставки и тестирование. 

![](https://habrastorage.org/webt/md/wh/w8/mdwhw8xomljief8knbv7tryjocm.jpeg)

Да, «лапша» из проводов так и просит что-то с этим сделать, но я держу себя в руках и не вмешиваюсь в процесс постройки :)

<cut>

## Детали устройства без микроконтроллера

Сначала обсудим самое важное - где взять необходимые детали. Сначала мы собрали и протестировали все без микроконтроллера, а когда прототип превратился в рабочее устройство, добавили к нему микропроцессорный модуль управления и дополнительные датчики, как будет рассмотрено далее.

Подходящий миникомпрессор на 80 кПа (как у оригинального компрессора Фишертехник) и напряжение питания 6V (от 9V стабильно работает, хотя шумит больше) плюс пневматические клапаны на 12V (тоже отлично работают от 9V и время срабатывания ощутимо не изменяется, при этом заметно греются, так что версия на 6V не подходит) показаны на картинке ниже:

![](https://habrastorage.org/webt/xe/mc/st/xemcstutogcwaz10y2yal1tehwa.jpeg)
На алиэкспресс компрессор и клапаны можно найти по названиям вида «DC 5V 6V Mini 030 Motor Aquarium Air Pump Oxygen Pump Diaphragm Pump 80Kpa» и «DC4.5V/6V/24V/12V 2 Position 3 Way Micro Mini Electric Solenoid Valve For Gas Air Pump» по цене в пару американских долларов за штуку.

Если добавить накопитель сжатого воздуха [Ресивер пневматический 30х40 черный](http://pacpac.ru/product/156493-pneumatic-tank-30x60-black/), то можно с помощью модуля Mini360 напряжение питания на компрессоре снизить до рекомендованных 5-6V для тихой его работы без ущерба для силы пневматических толкателей. Кстати, если вместо пневматического ресивера установить на компрессор шланг подлиннее, это тоже может несколько улучшить работу пневматических толкателей, хотя при длинном шланге чревато заметной потерей давления и ухудшением работы. А еще можно использовать в качестве накопителей один или несколько пневматических цилиндров. Итак, мы попробовали все эти варианты и остановились на оригинальном пневматическом ресивере.

Пневматические трубки Фишертехник можно заменить или дополнить любыми другими с внешним диаметром 4 мм и внутренним около 2 мм. По цене получится примерно одинаково, зато у сторонних трубок доступно много цветов и разная жесткость. Если захочется добавить тройники и штуцеры, то их лучше брать оригинальные, качественные совместимые оказываются дороже и не имеют креплений для деталей Фишертехник.

Для электропитания подойдет оригинальный аккумулятор Фишертехник или другая сборка аккумуляторов NiMh 8.4V (реальное напряжение 9-10V у свежезаряженной батареи). С LiPo батарейкой формфактора «Крона» и напряжением 8.3V устройство тоже работает, но при отсутствии накопителя сжатого воздуха отзывчивость управления пневматическими катапультами снижается. При наличии накопителя и установленном на компрессор понижающем напряжение модуле разница между указанными источниками питания только в продолжительности работы без подзарядки.

В качестве кнопки на картинке показан оригинальный [Миниатюрный переключатель](http://pacpac.ru/product/37783/). Он действительно удобен и надёжен, хотя здесь его можно заменить любым другим выключателем или джойстиком или даже пультом дистанционного управления в версии с микроконтроллером.

Детали [Пневматический цилиндр 60 с пружиной](http://pacpac.ru/product/133027/) мы использовали оригинальные, заказав их из каталога. Заменить их на цилиндр без возвратной пружины и отдельно взятую пружинку не получилось, а стоимость сторонних качественных миниатюрных пневматических цилиндров такова, что идея взять хотя бы один для теста отпала сама собой.

Электромеханический детектор шарика в официальной инструкции не описан, но нам показалось интересным его добавить. Всего-то и нужно поставить две стальные оси так, чтобы шарик их замыкал, когда выкатывается вниз или в лабиринте. Стальные оси для детектора шарика доступны во многих наборах Фишертехника или в каталоге деталей. Также на Алиэкспресс есть стальные трубки наружным диаметром 4 мм и внутренним 2 мм, внутри которых можно нарезать резьбу M2.5 для надежного подключения контактов, как мы и сделали. Замечу, что резьбу M2.5 в стальной трубке ребенок 7+ лет способен нарезать самостоятельно при наличии дрель-патрона для удержания трубки.

Остальные детали для постройки лабиринта, лампочки и стальной шарик можно взять из других наборов Фишертехника или заказать из каталога или заменить на свой вкус и цвет.

## Детали версии с микроконтроллером Microbit

Теперь про те детали, которые дополнительно потребуются для сборки версии с микроконтроллером.

В качестве микроконтроллера мы выбрали [BBC MicroBit](https://microbit.org) стоимостью около 15$ за удобство его программирования на скрэтч-подобном языке и прошивки через Bluetooth с планшета, а также множество доступных плат расширения, подробнее смотрите [Конструкторы Fischertechnik плюс одноплатный компьютер BBC Micro:Bit, устройства «для Arduino» и детали 3D принтеров](https://habr.com/ru/post/522922/).

Плата расширения здесь использована [Kitronik Compact Motor Driver Board for the BBC micro:bit](https://kitronik.co.uk/products/5698-compact-motor-driver-board-for-the-bbc-micro-bit) стоимостью около 10$, поскольку она одна из самых компактных и предоставляет все нужные порты. Другие доступные варианты смотрите в статье по ссылке выше. Можно обойтись и вовсе без платы расширения, тогда для подключения электромагнитных клапанов к микроконтроллеру удобно использовать [массив из 8ми транзисторов Дарлингтона ULN2803](https://www.ti.com/lit/ds/symlink/uln2803a.pdf). Эта копеечная микросхема содержит 8 входов и выходов до 0.5A и 50V каждый плюс два контакта для выводов питания. Кстати, входы и выходы можно подключать параллельно, что позволяет управлять двумя мощными моторами на 2A или другой нагрузкой. А еще в микросхеме уже встроены защитные диоды на каждый выход. В общем, оптимальное решение для подключения однополярных устройств вроде электромагнитных клапанов, моторов постоянного тока без реверса, лампочек Фишертехник и так далее.

Световой барьер описан в статье [Конструкторы Fischertechnik плюс одноплатный компьютер BBC Micro:Bit, устройства «для Arduino» и детали 3D принтеров](https://habr.com/ru/post/522922/).

## Детали версии с микроконтроллером Raspberry Pi Pico

Конечно, выбор микроконтроллера во многом дело вкуса, поэтому мы рассмотрим еще один вариант с недавно появившимся на свет [Raspberry Pi Pico](https://www.raspberrypi.org/products/raspberry-pi-pico/) от известной одноименной компании ценой около 4$. От BBC Microbit этот контроллер отличается, в том числе, отсутствием сетевых интерфейсов и наличием 16 каналов PWM и 8 каналов Programmable I/O (PIO) state machines for custom peripheral support. Последняя возможность выглядит особенно интересной при программировании на MicroPython или CircuitPython, смотрите подробнее [Programmable I/O with Raspberry Pi Pico](https://www.seeedstudio.com/blog/2021/01/25/programmable-io-with-raspberry-pi-pico/). А еще он легко помещается в коробочку для батарейки Фишертехник вместе с необходимым ему преобразователем напряжения Mini360 для подключения к стандартному для Фишертехник напряжению 9V. Также доступна аналогичная использованной с BBC Microbit плата расширения [Kitronik Motor Driver Board for Raspberry Pi Pico](https://kitronik.co.uk/products/5331-kitronik-compact-motor-driver-board-for-raspberry-pi-pico) с идентичной ценой около 10$. Аналогично Microbit, для rPi Pico предлагается свой скрэтч-подобный язык программирования, смотрите [Drag-n-drop coding for Raspberry Pi Pico](https://www.raspberrypi.org/blog/drag-n-drop-coding-for-raspberry-pi-pico/).

Для ценителей Ардуино в ближайшем прошлом (месяц назад должен был состояться релиз) обещают на этом же процессоре [Arduino Nano RP2040 Connect](https://store.arduino.cc/usa/nano-rp2040-connect-with-headers) аналогичного размера за 25.5$ уже со встроенными сетевыми модулями и возможностью работы с [Arduino Cloud IoT](https://docs.arduino.cc/cloud/iot-cloud). Посмотрим, возможно, это окажется интересный вариант.

## Заключение

Подобрав и заказав необходимые детали, теперь я только участвую в обсуждениях конструкции, а собирает (и периодически разбирает) сын самостоятельно. Если вам будет интересно, могу написать продолжение статьи и показать, в том числе, замеры давления, создаваемого компрессором от разных источников питания, минимизация шума компрессора с помощью управления его электропитанием и видео работы.

## Также смотрите

* [Мои статьи на Хабре](https://habr.com/ru/users/n-cube/posts/)
* [Теоретические и практические статьи и посты на LinkedIn](https://www.linkedin.com/in/alexey-pechnikov/)
* [Геологические модели и код на GitHub](https://github.com/mobigroup)
* [YouTube канал с геологическими моделями](https://www.youtube.com/channel/UCSEeXKAn9f_bDiTjT6l87Lg)
* [Геологические модели в виртуальной/дополненной реальности (VR/AR)](https://mobigroup.github.io/ParaView-Blender-AR/)