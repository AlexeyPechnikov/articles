# Как визуализировать и анимировать (геофизические) модели. Воксельные модели и сетчатые поверхности

Опубликовано https://habr.com/ru/post/493198/

Также смотрите другие статьи серии "Как визуализировать и анимировать (геофизические) модели":

 * [Вводная статья со списком используемого программного обеспечения](https://habr.com/ru/post/492362/)
 * [Показываем исходные данные](https://habr.com/ru/post/492456/)
 * [3D анимация и визуализация 4D данных](https://habr.com/ru/post/492844/)
 * [Информативность визуализации](https://habr.com/ru/post/492924/)
 * Воксельные модели и сетчатые поверхности

В результате численного моделирования мы обычно получаем воксельные модели, которые для дальнейшей обработки и анализа необходимо преобразовывать в сетчатые поверхности. На картинке ниже в полупрозрачной воксельной модели изображена геологическая структура, выделенная и преобразованная в сетчатую поверхность и дополненная поверхностью рельефа.

![3D Geological Modeling](https://habrastorage.org/webt/kt/im/nf/ktimnf7_n9r3-ok7xfoz2jjvkfi.jpeg)

<cut />

## Постановка задачи

Численно-разностные методы и другие технологии моделирования мне знакомы еще с университета, и для научной работы было достаточно показать полученные результаты. В случае же геологического проекта это лишь часть работы - далее необходимо выделить определенные структуры, посчитать их объемы, плотность, концентрации различных полезных ископаемых и прочие характеристики. Самое простой путь - это использовать фильтрацию по диапазону значений (фильтр Threshold в ParaView) и показать полученную воксельную модель, пригодную для оценки объема. Объем полученной модели зачастую слишком большой и визуализация усложняется, но, в общем и целом, этого достаточно для вычисления объема и представления результатов.  Что же касается отображения отдельных структур, моделирования потоков жидкости в них и так далее - нужны другие методы. Тем более, зачастую требуется возможность ручной корректировки выделенных структур - например, возможность раскрасить части структур или удалить незначимые детали. Здесь мне пришлось испробовать уйму различных методов и программного обеспечения, а в итоге указанная проблема разрешилась очень просто и даже элегантно. Решением является переход от воксельной модели к сетчатым моделям с помощью, как правило, выделения изоповерхностей (фильтр Contour в ParaView) по различным свойствам (атрибутам ячеек воксельной модели). Для хранения и передачи поверхностей удобно использовать формат STL (а также OBJ, PLY), в который можно их сохранить из ParaView и открыть во многих других программах. 

## Исходные данные

Все модели и изображения выложены на GitHub, смотрите ссылку в конце статьи.

## Визуализация результатов

Рассмотрим пример визуализации воксельной модели, полученной решением обратной задачи гравики, то есть модель плотности геологической среды, построенную на основе значений гравитационного поля на поверхности:

![](https://habrastorage.org/webt/kp/_l/l-/kp_ll-e92tcrpi06i__o-qddw1w.jpeg)

Искомая структура в центре видна, но ее форма трудно различима. Сравним с визуализацией в виде сетчатой поверхности:
![](https://habrastorage.org/webt/fz/o5/j9/fzo5j9i7olydebkoltqlt3zk-98.jpeg)

Разница очевидна - в таком представлении все детали геологического строения видны безошибочно. Совместив оба представления, можно получить визуализацию для презентации результатов:

![3D Geological Modeling](https://habrastorage.org/webt/kt/im/nf/ktimnf7_n9r3-ok7xfoz2jjvkfi.jpeg)

## Ссылки

[ParaView project for geological exploration on Mosha fault area, North Iran](https://github.com/mobigroup/ParaView-MoshaFault)