# Вычислительная геология и визуализация

Опубликовано https://habr.com/ru/post/545878/

Мы уже обсуждали современные методы в геологии в статье [Геология XXI века как наука данных о Земле](https://habr.com/ru/post/507138/) на примере модели землетрясения в горном массиве Монте Кристо в Неваде, США 15 мая 2020 года магнитудой 6.5 баллов. И все бы хорошо в этой модели, да вот только самое интересное - смещение геологических блоков и "дыхание гор" нам схематично указал опытный геолог. Самое же важное заключается в том, что современная вычислительная геология (включая геофизику, моделирование и визуализацию) позволяет создать динамическую (4D) геологическую модель и наяву увидеть происходящие геологические процессы.

![](https://habrastorage.org/webt/tq/_h/fu/tq_hfulym8_hi3_78bgliowacsi.png)

Геологическая модель с интерферограммой на поверхности рельефа по данным радарной спутниковой съемки, где на шкале Density Anomaly,% является характеристикой неоднородности геологической плотности и черная сфера в центре указывает координаты эпицентра землетрясения, расположенного на глубине 2.8 км.

<cut/>

Поскольку в указанной выше статье мы уже рассмотрели статичную модель, сразу перейдем к динамической модели и ее визуализации. Как обычно, воспользуемся для этого Open Source программой  [ParaView](https://www.paraview.org) и моим расширением для ГИС данных [N-Cube ParaView plugin for 3D/4D GIS Data Visualization](https://github.com/mobigroup/ParaView-plugins). Вот как выглядит проект ParaView:

![](https://habrastorage.org/webt/ac/ab/mj/acabmjknc0abvpqk7fzpjzlvlf8.png)

Напомню, что геологическую модель мы создаем методом так называемой геофизической инверсии, когда на основе данных гравитационного поля на поверхности Земли вычисляем соответствующее распределение плотности под этой поверхностью. Увы, но измерения непосредственно гравитационного поля (или нужной нам вертикальной его компоненты) с такой точностью и периодичностью не производятся, поэтому воспользуемся заместо этого открыто доступными регулярными радарными снимками. Дело в том, что пространственные спектры гравитационного поля, рельефа и радарных (и оптических) снимков практически эквивалентны, что и дает возможность восстановить распределение плотности с точностью до множителя. Если вам интересны детали, то в GitHub репозитории [GIS Snippets](https://github.com/mobigroup/gis-snippets) доступны Jupyter Python 3 ноутбуки с соответствующими моделями (и ссылками на теоретические основы). Спутниковая интерферограмма получена средствами замечательного открытого тулкита [GMTSAR](https://topex.ucsd.edu/gmtsar/).

В случае однократного землетрясения смещение даже огромных геологических массивов происходит достаточно быстро, и сам процесс, разумеется, зарегистрировать почти невозможно, если только (чудесным образом)  именно в этот момент не будет получен один из регулярных космических снимков. На практике же нам приходится довольствоваться снимками за несколько дней до и несколько дней после землетрясения. Используя такие снимки, мы построили две модели для выбранного участка Монте Кристо. Также представляют интерес снимки, сделанные через несколько недель после события - после так называемого процесса релаксации недра Земли приходят в новое устойчивое состояние, при этом вероятны небольшие (относительно первоначального смещения) подвижки геологических блоков. Поскольку в нашем случае такое смещение достаточно мало, здесь мы не будем пытаться его визуализировать. В случае повторяющихся землетрясений на одной территории возможно построить и более сложные модели, показывающие промежуточные геологические состояния, хотя это связано с техническими сложностями корректного вычисления результата многократных смещений территории (по трем координатным осям) за период времени в годы и десятки лет. Впрочем, и эта задача успешно решается, теорию и практические примеры можно найти в документации к открытому программному пакету [GMTSAR](https://topex.ucsd.edu/gmtsar/).

Итак, у нас есть две геологические модели и интерферограмма, сделанные в момент времени до и после землетрясения. В данном случае, когда не произошло катастрофических геологических нарушений, мы можем воспользоваться фильтром TemporalInterpolator в ParaView для интерполяции промежуточных состояний в моменты времени между нашими двумя моделями. Началом интервала времени для интерполяции является состояние до землетрясения, а окончанием - состояние после этого события. Признаться, сначала я попытался сделать плавную анимацию процесса, но добился этим лишь того, что смещения вообще оказались визуально не заметными. С пошаговой анимацией дело пошло лучше и смещения геологических блоков стали хорошо различимы:

![](https://habrastorage.org/webt/9o/ty/3n/9oty3nzj4pdbwzm8qpuc0h9svam.gif)

Здесь мы видим, как опускается расположенный близко к поверхности в левой части модели геологический блок и поднимается геологическая структура в правой части, при этом происходит некоторое уплотнение ("утряска") субгоризонтального слоя в середине модели без его горизонтального смещения. Полученная картина в точности соответствует описанию геолога, зато теперь мы сами все это можем увидеть. Обратим внимание, что эпицентр землетрясения соответствует месту стыковки геологических блоков, что совершенно очевидно для геолога и свидетельствует о том, что подобные смещения происходили и происходят многократно. Именно так за миллионы лет и "растут горы":

![](https://hsto.org/webt/yi/m3/3t/yim33tnueij7o_0dwwxg3m4-404.jpeg)

Красным цветом на интерферограмме показаны поднявшиеся участки (в данном случае, на 20-30 см), а синим - опустившиеся (на 15-20 см). Смотрите подробнее в статье [Общедоступные данные дистанционного зондирования Земли: как получить и использовать](https://habr.com/ru/post/505578/)

В заключение скажу, что сам я очень рад увидеть такую динамическую модель - несмотря на более чем десятилетнюю работу с геологами и десятки построенных 3D геологических моделей, мне все еще были не очень понятны их объяснения динамики смещения, поворотов и скольжения геологических блоков... Еще замечу, что данная динамическая модель построена исключительно для удовлетворения моего научного интереса, поскольку для геолога здесь и так все очевидно.

В заключение, приглашаю всех посетить [GitHub репозитории](https://github.com/mobigroup) с множеством геологических моделей и их визуализацией в Blender и ParaView, а также примерами анализа пространственных спектров, синтеза гравитационных данных высокого разрешения на основе данных дистанционного зондирования и другими вычислениями, в том числе, выполняемыми на геоиде средствами PostgreSQL/PostGIS. Также смотрите готовые визуализации на [YouTube канале](https://www.youtube.com/channel/UCSEeXKAn9f_bDiTjT6l87Lg).